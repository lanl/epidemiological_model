default:
  image: continuumio/miniconda3:latest
  before_script:
      - apt-get update -q -y
      - apt-get install -y build-essential
      - pwd
      - conda env create --file human-epi-env.yml
      - conda init bash
      - source ~/.bashrc
      - conda activate human-epi-env

stages:
  - test
  - docs

test:
  stage: test
  script:
    - cd Epi_SEIR
    - pytest --junitxml=report.xml
  artifacts:
    when: always
    reports:
      junit: Epi_SEIR/report.xml

docs:
  stage: docs
  script:
    - cd Epi_SEIR/docs
    - pip install sphinx-rtd-theme
    - make clean
    - make html
  artifacts:
    paths:
      - Epi_SEIR/docs/_build/html
